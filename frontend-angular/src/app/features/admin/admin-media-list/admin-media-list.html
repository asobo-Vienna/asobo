<h2 class="component">All Media</h2>

<div class="view-toggle" role="group" aria-label="View mode">
  <button class="btn btn-sm" [class.btn-purple]="viewMode() === 'table'" [class.btn-outline-secondary]="viewMode() === 'card'" (click)="viewMode.set('table')" aria-label="Table view" [attr.aria-pressed]="viewMode() === 'table'">
    <i class="pi pi-table" aria-hidden="true"></i>
  </button>
  <button class="btn btn-sm" [class.btn-purple]="viewMode() === 'card'" [class.btn-outline-secondary]="viewMode() === 'table'" (click)="viewMode.set('card')" aria-label="Card view" [attr.aria-pressed]="viewMode() === 'card'">
    <i class="pi pi-th-large" aria-hidden="true"></i>
  </button>
</div>

<div class="table-wrapper" [class.card-view]="viewMode() === 'card'">
  <p-table
    [value]="mediaItems()"
    [loading]="loading()"
    [paginator]="true"
    [rows]="environment.defaultPageSize"
    [totalRecords]="totalRecords()"
    [lazy]="true"
    (onLazyLoad)="onPageChange($event)"
  >
    <ng-template pTemplate="header">
      <tr>
        <th scope="col"></th>
        <th scope="col" aria-label="Id">ID</th>
        <th scope="col" aria-label="Event Title">Event Title</th>
        <th scope="col" aria-label="Edit"></th>
        <th scope="col" aria-label="Delete"></th>
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-mediaItem>
      <tr>
        <td data-label="">
          <img
            [src]="
            (UrlUtilService.getMediaUrl(
              mediaItem.mediumURI || environment.eventDummyCoverPicRelativeUrl
            )  | secureImage | async) || ''
          "
            [alt]="mediaItem.caption"
            class="mediaItem-thumbnail"
          />
        </td>
        <td data-label="ID"><span class="p-column-title"><small>{{ mediaItem.id }}</small></span></td>
        <td data-label="Event">
          <span class="p-column-title">
            <a [routerLink]="getEventRouterLink(mediaItem.eventId)"
               class="a-clickable">{{ mediaItem.eventTitle }}</a>
          </span>
        </td>

        <td data-label="Edit">
          <span class="p-column-title">
            <i
              class="pi pi-pencil clickable"
              title="Edit"
              (click)="onEdit(mediaItem)"
              aria-label="Edit medium"
            ></i>
          </span>
        </td>
        <td data-label="Delete">
          <span class="p-column-title">
            <i
              class="pi pi-trash clickable"
              title="Delete"
              (click)="onDelete(mediaItem)"
              aria-label="Delete medium"
            ></i>
          </span>
        </td>
      </tr>
    </ng-template>
  </p-table>

  @if (loading()) {
    <app-spinner type="overlay" message="Loading media..."/>
  }
</div>
